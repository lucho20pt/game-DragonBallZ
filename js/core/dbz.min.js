if(com_canvas){if(com_canvas&&"object"!=typeof com_canvas)throw Error("com_canvas is not an Object type")}else var com_canvas={};com_canvas.Main=function(){return{NAME:"Application initialize module",VERSION:1,AUTHOR:"Daniel Batista",YEAR:2013,init:function(){this.dbzGame()},dbzGame:function(){var e,n;$("canvas#dbz").length||retur,$("#dbzWellcome a").click(function(){return $(this).parent().fadeOut(800,function(){$("#dbzIntroctions, #dbzMovement").fadeIn(800),$("#dbzIntroctions a").click(function(){return $(this).parent().fadeOut(800,function(){$("#dbzInitGame").fadeIn(800),$("#playerSave").click(function(){var t,i;return e=$("input#nickName").val(),audioPunch.volume=.05,audioTeleport.volume=.05,audioInGame.volume=.2,$("#dbzIntroScreen").hide(),audioInGame.play(),$("#dbzBlock").css("background","url(images/bg_namek_790.jpg) no-repeat center center"),$("#sound a").click(function(){return $(this).toggleClass("off"),!0==$("a.off").is(":visible")?audioInGame.pause():audioInGame.play(),!1}),i=4,t=window.setInterval(function(){if(i--,$("#preTimer").remove(),$("<div id='preTimer'>"+i+"</div>").appendTo("#dbzBlock"),0===i){$("#preTimer").remove(),$("<div id='preTimer'><span>GO</span></div>").appendTo("#dbzBlock"),setTimeout(function(){var t,i,a,o,r,l,c,s,d,f,u,p,m,g,v,y,x,_,k,b,h,w,I,z,T,A;$("#preTimer").remove(),a=(i=document.getElementById("dbz")).getContext("2d"),o=0,r=1100,l=0,c=60,s=window.setInterval(function(){if(0==--c){clearInterval(s),clearInterval(l);return}},1e3),d=!1,(f=new Image).onload=function(){d=!0},f.src="images/bg_namek_790.jpg",u=!1,(p=new Image).onload=function(){u=!0},p.src="images/bg_namek_790_over.jpg",m=!1,(g=new Image).onload=function(){m=!0},g.src="images/ico_goku.png",v=!1,(y=new Image).onload=function(){v=!0},y.src="images/ico_goku_over.png",x=!1,(_=new Image).onload=function(){x=!0},_.src="images/ico_freezer.png",k={speed:500,x:0,y:0},b={x:0,y:0},h={},addEventListener("keydown",function(e){h[e.keyCode]=!0},!1),addEventListener("keyup",function(e){delete h[e.keyCode]},!1),w=function(e){e?(k.x=i.width/2,k.y=i.height/2,audioTeleport.pause()):audioTeleport.play(),b.x=32+Math.random()*(i.width-64),b.y=32+Math.random()*(i.height-64),l>0&&clearInterval(l),l=setInterval(w,r)},I=function(e){38 in h&&(k.y-=k.speed*e),40 in h&&(k.y+=k.speed*e),37 in h&&(k.x-=k.speed*e),39 in h&&(k.x+=k.speed*e),k.x<=b.x+32&&b.x<=k.x+32&&k.y<=b.y+32&&b.y<=k.y+32&&(++o,w(!0),audioPunch.play())},z=function(){if(d&&a.drawImage(f,0,0),0===c){u&&a.drawImage(p,0,0),(void 0===e||""===e)&&(e="Vegeta :)");var r=i.width/2,s=i.height/2;return a.fillStyle="yellow",a.font="72px Arial",a.textAlign="center",a.textBaseline="middle",a.fillText("Game Over",r,s-160),a.font="30px Arial",a.lineWidth=2,a.strokeStyle="orange",a.fillText(e,r,s+60),a.strokeStyle="#FFF",a.font="32px Arial",a.fillText("Your Total Score is:",r,s+100),a.fillStyle="#fff",a.font="40px Arial",a.fillText(o,r,s+145),n=o,k.x=i.width/2-20,k.y=i.height/2-120,v&&a.drawImage(y,k.x,k.y),clearInterval(t),clearInterval(l),console.log("-> post nicks and scores to DB"),$("#restart").fadeIn(100,function(){$("#restart a").click(function(){d&&a.drawImage(f,0,0),$("#restart").css("display","none"),$("#dbzBlock").css("background","url(images/bg_namek_790.jpg) no-repeat center center"),audioInGame.currentTime=0,$("#sound a").removeClass("off"),$("#sound a").click(function(){return $(this).toggleClass("off"),!0==$("a.off").is(":visible")?audioInGame.pause():audioInGame.play(),!1}),window.location.reload()})}),!0}m&&a.drawImage(g,k.x,k.y),x&&a.drawImage(_,b.x,b.y);var r=i.width-12,s=12;a.fillStyle="purple",a.font="24px Arial Black",a.textAlign="right",a.textBaseline="top",a.fillText("time: "+c+" sec      ",r,s),a.fillStyle="purple",a.font="24px Arial Black",a.textAlign="left",a.textBaseline="top",a.fillText("      points: "+o,12,12)},T=function(){var e=Date.now();I((e-A)/1e3),z(),A=e},w(!0),A=Date.now(),t=setInterval(T,1)},1e3),clearInterval(t);return}},1e3),!1})}),!1})}),!1}),console.log("-> get score list from DB")}}};var templateMain=DBT=com_canvas.Main();$(document).ready(function(){DBT.init()});